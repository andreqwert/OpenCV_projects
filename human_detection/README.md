# Скрипт для обнаружения людей

Скрипт позволяет найти на фотографии людей. 

**1.** Под "капотом" - гистограмма направленных градиентов (HOG) с методом опорных векторов. Реализация имеет упрощённо примерно следующий вид:

*1.1. (В данном случае выборка уже натренирована, но в общем случае) необходимо создать выборку с фотографиями, где объект есть и где его нет.*

*1.2. В каждой точке каждого фото считается градиент и в зависимости от направления его значение добавляется к гистограмме.*

*1.3. Гистограммы группируются в блоки для нормировки.*

*1.4. Из блоков строятся массивы. Эти массивы будут вектор-точками в n-мерном пространстве.*

*1.5. Массивы разделяются по методу опорных векторов.*

Таким образом, каждое изображение отнесено к одному из двух классов, и там, где объект есть, изображение отражает характерную гистограмму.
Полная статья от создателей метода: http://lear.inrialpes.fr/people/triggs/pubs/Dalal-cvpr05.pdf

**2.** Далее на каждом изображении "пробегаем" окном 4 на 4 пикселя, на каждой эпохе уменьшая изображение относительно исходного пирамидально. Это необходимо для того чтобы искать людей при разных масштабах (например, люди вблизи и вдалеке имеют разные формы, а значит и интерпретацию попиксельно). Подробнее: https://www.pyimagesearch.com/2015/11/16/hog-detectmultiscale-parameters-explained/

**3.** Применяется функция `non-max-suppression`. Она необходима, чтобы соединять между собой блоки обнаруженных объектов в один. Например, обнаружен человек, но по ошибке в прямоугольник заключены также и его голова и нога. `non-max-suppression` приводит к такому виду, чтоб был обведён **только** человек целиком. 

**4.** Люди обводятся в прямоугольники, и картинка выводится. Опционально в командной строке добавляется информация о ходе результатов алгоритма.

## Запуск

1. `Утилиты` --> `Терминал`;                      
2. `python3 human_detection.py --images people_to_detect`, где `people_to_detect` - папка с изображениями, которые необходимо обработать. 

Опционально: `pip3 install imutils`;  

Сделано в качестве учебной задачи. Источник: pyimagesearch.com
