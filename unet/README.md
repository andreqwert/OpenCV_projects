# U-net

## Запуск
Для запуска необходимо:      
1. Загрузить датасет с изображениями, полученными в ходе ультразвуковой диагонстики. Распаковать `test` и `train` в папку `raw`.
https://www.kaggle.com/c/ultrasound-nerve-segmentation/data        
Таким образом, обучающая и контрольная выборки будут в папке `train`, а тестовая - в папке `test`. Все изображения контрольной
выборки должны иметь формат `<image_name>_mask.tif` (в датасете уже всё готово).
2. Далее нужно запустить файл `data.py`. С помощью этого файла можно сформировать файлы с массивами изображений `.npy` на каждую
из выборок. Размеры изображения должны быть фиксированными, то есть количество строк матрицы и столбцов матрицы у всех изображений
должно быть одинаковое. Выходные `.npy` по умолчанию сохраняются в корень репозитория.  
3. Запустить файл на обучение `train.py`. По быстродействию:        
4 гб. ОЗУ, 256 мб. видео -> 21 час на 30 изображений размера 512х512 (24 изображения обучающей выборки + 6 контрольной).
По окончании каждой эпохи будут обновляться веса нейронки в файле `.h5`, он сохранится в корень.
4. После обучения нейронки начнется прогон тестовых изображений по полученным весам. Это не разнесено на отдельную функцию, поэтому
придётся ждать, когда нейронка досчитает, что делает несколько бессмысленным вообще записывание `.h5`, по-хорошему для больших
выборок эти функции было бы полезным разнести на `train` и `test_predict`.      
Выходной размер изображений также задаётся. По умолчанию предполагались выборки с изображением низкого качества для ускорения работы
и в целом для демонстрации работоспособности - поэтому в файлах размер выходных изображений всего 96 на 96. Менять его нужно кратно.

